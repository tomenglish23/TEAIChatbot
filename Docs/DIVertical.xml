<mxfile host="app.diagrams.net" modified="2025-12-08T12:00:00Z" agent="5.0" version="22.0.0" editor="draw.io">
  <diagram id="TEAI_Vertical" name="TEAIChatbot DI Vertical">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Social / Web Clients (top) -->
        <mxCell id="clients_box" value="Social / Web Clients&#10;FB Page, LinkedIn, Test Console" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="40" width="260" height="80" as="geometry"/>
        </mxCell>

        <!-- IngressFunction [Scoped] -->
        <mxCell id="ingress_box" value="IngressFunction&#10;(HTTP / Webhook)&#10;[Scoped]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="150" width="260" height="90" as="geometry"/>
        </mxCell>

        <!-- SocialEventHandler [Scoped] -->
        <mxCell id="handler_box" value="SocialEventHandler&#10;Orchestrator&#10;[Scoped]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="270" width="260" height="100" as="geometry"/>
        </mxCell>

        <!-- IChatSessionRepository [Scoped] -->
        <mxCell id="repo_box" value="IChatSessionRepository&#10;(Table / SQL / Stub)&#10;[Scoped]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="400" width="260" height="90" as="geometry"/>
        </mxCell>

        <!-- Storage Layer -->
        <mxCell id="storage_box" value="Storage Layer&#10;Table, Blob, SQL, External APIs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="510" width="260" height="90" as="geometry"/>
        </mxCell>

        <!-- IFlowEngine [Singleton] -->
        <mxCell id="engine_box" value="IFlowEngine&#10;(JsonFlowEngine / Stub / RecordingStub)&#10;[Singleton]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="630" width="260" height="110" as="geometry"/>
        </mxCell>

        <!-- Flow Definitions & Config -->
        <mxCell id="config_box" value="Flow Definitions &amp; Config&#10;JSON flows, settings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="480" y="770" width="260" height="90" as="geometry"/>
        </mxCell>

        <!-- Lifetime legend (side) -->
        <mxCell id="legend_box" value="[Transient] new instance per request&#10;[Scoped] one instance per Function invocation&#10;[Singleton] one instance for host lifetime" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#999999;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="800" y="150" width="320" height="120" as="geometry"/>
        </mxCell>

        <!-- Edges (vertical flow) -->
        <mxCell id="edge_clients_ingress" edge="1" parent="1" source="clients_box" target="ingress_box" style="endArrow=block;strokeWidth=1.5;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_ingress_handler" edge="1" parent="1" source="ingress_box" target="handler_box" style="endArrow=block;strokeWidth=1.5;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_handler_repo" edge="1" parent="1" source="handler_box" target="repo_box" style="endArrow=block;strokeWidth=1.5;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_repo_storage" edge="1" parent="1" source="repo_box" target="storage_box" style="endArrow=block;strokeWidth=1.5;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_storage_engine" edge="1" parent="1" source="storage_box" target="engine_box" style="endArrow=block;strokeWidth=1.5;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <mxCell id="edge_engine_config" edge="1" parent="1" source="engine_box" target="config_box" style="endArrow=block;strokeWidth=1.5;">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

